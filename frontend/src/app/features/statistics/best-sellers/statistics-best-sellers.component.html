<div class="space-y-6">
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-3xl font-bold text-gray-800">M√°s y Menos Vendidos</h1>
      <p class="text-gray-600 mt-1">An√°lisis de ventas por producto</p>
    </div>
    <select [(ngModel)]="selectedPeriod" (change)="loadStatistics()" class="input-field max-w-xs">
      <option *ngFor="let opt of periodOptions" [value]="opt.value">{{ opt.label }}</option>
    </select>
  </div>
  
  <div *ngIf="loading" class="flex items-center justify-center py-12">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div>
  </div>
  
  <div *ngIf="!loading && statistics" class="space-y-6">
    <!-- Charts -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div *ngIf="hasProductStatistics" class="card">
        <h2 class="text-xl font-bold mb-4">Productos M√°s Vendidos (Gr√°fico)</h2>
        <app-bar-chart 
          [labels]="bestProductsChartData.labels" 
          [data]="bestProductsChartData.data"
          label="Unidades Vendidas"
          color="#10b981"
          [horizontal]="true">
        </app-bar-chart>
      </div>
      
      <div *ngIf="hasMenuStatistics" class="card">
        <h2 class="text-xl font-bold mb-4">Men√∫ M√°s Vendido (Gr√°fico)</h2>
        <app-bar-chart 
          [labels]="bestMenuChartData.labels" 
          [data]="bestMenuChartData.data"
          label="√ìrdenes"
          color="#3b82f6"
          [horizontal]="true">
        </app-bar-chart>
      </div>
    </div>
    
    <!-- Tables -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Productos M√°s Vendidos -->
    <div *ngIf="hasProductStatistics" class="card">
      <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
        <span class="text-2xl">üèÜ</span>
        Productos M√°s Vendidos
      </h2>
      <div *ngIf="(statistics.best_products || []).length === 0" class="text-center py-8 text-gray-500">
        No hay datos disponibles
      </div>
      <div *ngIf="(statistics.best_products || []).length > 0" class="space-y-3">
        <div *ngFor="let product of statistics.best_products; let i = index" class="flex items-center gap-3 p-3 bg-gradient-to-r from-green-50 to-white rounded-lg border border-green-200">
          <div class="w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-sm">
            {{ i + 1 }}
          </div>
          <div class="flex-1">
            <p class="font-semibold">{{ product.name }}</p>
            <p class="text-sm text-gray-600">{{ product.quantity }} unidades vendidas</p>
          </div>
          <div class="text-right">
            <p class="text-lg font-bold text-green-600">${{ (product.total_sales ?? 0).toFixed(2) }}</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- √çtems de Men√∫ M√°s Vendidos -->
    <div *ngIf="hasMenuStatistics" class="card">
      <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
        <span class="text-2xl">üçΩÔ∏è</span>
        Men√∫ M√°s Vendido
      </h2>
      <div *ngIf="(statistics.best_menu_items || []).length === 0" class="text-center py-8 text-gray-500">
        No hay datos disponibles
      </div>
      <div *ngIf="(statistics.best_menu_items || []).length > 0" class="space-y-3">
        <div *ngFor="let item of statistics.best_menu_items; let i = index" class="flex items-center gap-3 p-3 bg-gradient-to-r from-blue-50 to-white rounded-lg border border-blue-200">
          <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm">
            {{ i + 1 }}
          </div>
          <div class="flex-1">
            <p class="font-semibold">{{ item.name }}</p>
            <p class="text-sm text-gray-600">{{ item.quantity }} √≥rdenes</p>
          </div>
          <div class="text-right">
            <p class="text-lg font-bold text-blue-600">${{ (item.total_sales ?? 0).toFixed(2) }}</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Productos Menos Vendidos -->
    <div *ngIf="hasProductStatistics" class="card lg:col-span-2">
      <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
        <span class="text-2xl">üìâ</span>
        Productos Menos Vendidos
      </h2>
      <div *ngIf="(statistics.worst_products || []).length === 0" class="text-center py-8 text-gray-500">
        No hay datos disponibles
      </div>
      <div *ngIf="(statistics.worst_products || []).length > 0" class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <div *ngFor="let product of statistics.worst_products" class="flex items-center gap-3 p-3 bg-orange-50 rounded-lg border border-orange-200">
          <div class="flex-1">
            <p class="font-semibold">{{ product.name }}</p>
            <p class="text-sm text-gray-600">Solo {{ product.quantity }} unidades</p>
          </div>
          <div class="text-right">
            <p class="text-lg font-bold text-orange-600">${{ (product.total_sales ?? 0).toFixed(2) }}</p>
          </div>
        </div>
      </div>
      <p class="text-xs text-gray-500 mt-4">üí° Considera revisar precios o promocionar estos productos</p>
    </div>
  </div>
  </div>
</div>

