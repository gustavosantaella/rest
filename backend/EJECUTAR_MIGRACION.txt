================================================================================
‚ö†Ô∏è  IMPORTANTE - LEE ESTO PRIMERO
================================================================================

El error que viste:
"column products.business_id does not exist"

Significa que la base de datos NO tiene el campo business_id todav√≠a.
Los MODELOS lo tienen, pero la BASE DE DATOS no.

================================================================================
‚úÖ SOLUCI√ìN - EJECUTAR EN ESTE ORDEN:
================================================================================

PASO 1: Detener el servidor (si est√° corriendo)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Presiona Ctrl+C en la terminal donde corre el servidor


PASO 2: Ejecutar la migraci√≥n de base de datos
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
cd backend
python migrate_add_business_id.py

Cuando te pregunte si deseas continuar, escribe: si


PASO 3: Verificar que la migraci√≥n fue exitosa
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Deber√≠as ver:
  ‚úÖ Tabla 'tables' procesada correctamente
  ‚úÖ Tabla 'products' procesada correctamente
  ‚úÖ Tabla 'categories' procesada correctamente
  ‚úÖ Tabla 'menu_items' procesada correctamente
  ‚úÖ Tabla 'menu_categories' procesada correctamente
  ‚úÖ Tabla 'orders' procesada correctamente


PASO 4: Iniciar el servidor nuevamente
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
python run_nest.py


PASO 5: Probar en el navegador
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
http://localhost:8000/docs


================================================================================
üéØ QU√â HACE LA MIGRACI√ìN
================================================================================

El script migrate_add_business_id.py va a:

1. Agregar la columna business_id a:
   - tables
   - products
   - categories
   - menu_items
   - menu_categories
   - orders

2. Asignar un business_id por defecto a los datos existentes

3. Crear foreign keys e √≠ndices

4. Quitar constraints unique globales que ahora son por negocio


================================================================================
‚ö†Ô∏è  BACKUP RECOMENDADO (OPCIONAL PERO SUGERIDO)
================================================================================

Antes de ejecutar la migraci√≥n, haz un backup:

# PostgreSQL
pg_dump -U postgres restaurant_db > backup.sql

# O desde pgAdmin exportar la base de datos


================================================================================
üêõ SI HAY ERRORES
================================================================================

Error: "relation does not exist"
‚Üí Algunas tablas no existen a√∫n
‚Üí Ejecuta primero: python init_db.py

Error: "permission denied"
‚Üí El usuario de BD no tiene permisos
‚Üí Usa un usuario con permisos de ALTER TABLE

Error: "constraint already exists"
‚Üí La migraci√≥n ya se ejecut√≥ parcialmente
‚Üí Es seguro, contin√∫a normalmente


================================================================================
‚ú® DESPU√âS DE LA MIGRACI√ìN
================================================================================

Una vez completada:
  ‚úÖ Todas las tablas tendr√°n business_id
  ‚úÖ Multi-tenancy estar√° funcionando
  ‚úÖ Cada negocio ver√° solo sus datos
  ‚úÖ La app funcionar√° correctamente


================================================================================
üöÄ COMANDO R√ÅPIDO (TODO EN UNO)
================================================================================

# Ejecutar migraci√≥n e iniciar servidor
python migrate_add_business_id.py && python run_nest.py


================================================================================
üìû AYUDA
================================================================================

Si tienes problemas, revisa:
  - MIGRACION_BUSINESS_ID.md
  - INSTRUCCIONES_MULTI_TENANCY.md
  - LEEME_PRIMERO.md


Fecha: 2025
Versi√≥n: 2.0.0
Estado: Requiere ejecuci√≥n de migraci√≥n

